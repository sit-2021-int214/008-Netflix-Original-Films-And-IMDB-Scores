#Part 1: Explore the dataset that you have select.

#library
library(dplyr)
library(readr)      
library(stringr)    
library(assertive)
library(ggplot2)

#dataset
superstore <- read.csv("https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/superstore_sales.csv")
View(superstore)   

glimpse(superstore)

#Part 2: Learning function from Tidyverse

superstore %>% group_by(City) %>% summarise(totalsales = sum(Sales))

superstore %>% count(Sub.Category) %>% group_by(Sub.Category) %>% rename(totalsales = n) %>% arrange(totalsales)

#Part 3: Transform data with dplyr and finding insight the data at least 6 issues. Show your code, result and summary in form of sentence/paragraphs.

#3.1
superstore %>% 
  group_by(City) %>% 
  summarise(totalsales = sum(Sales)) %>%
  filter(totalsales > 50000) %>%
  arrange(desc(totalsales))

#3.2
findXerox <- str_subset(superstore$Product.Name, "Xerox");
as_tibble(findXerox)

#3.3
superstore %>%group_by(Segment) %>% summarise(totalsales = sum(Sales)) %>% filter(Segment == "Consumer") 

#3.4
superstore %>% count(Sub.Category) %>% group_by(Sub.Category) %>% rename(totalsales = n) %>% arrange(desc(totalsales))

#3.5
totalSalesCus <- superstore %>% select(Customer.Name) %>% count(Customer.Name) %>% arrange(desc(n)) %>%  rename(totalbuy = n);

as_tibble(totalSalesCus);


#3.6
#?????????????????????????????????????????????????????????????????????????????????????????????
maxSale <- superstore %>% 
  group_by(Product.Name) %>% 
  summarise(totalsale = sum(Sales)) %>%
  filter(totalsale == max(totalsale))

#????????????????????????????????????????????????????????????????????????????????????????????????
minSale <- superstore %>% 
  group_by(Product.Name) %>% 
  summarise(totalsale = sum(Sales)) %>%
  filter(totalsale == min(totalsale))

#????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
different <- (maxSale$totalsale) -(minSale$totalsale)

maxSale
minSale
different

#Part 4: Using ggplot2 to create 2 graphs and explain each graph.

#4.1
superstore  %>% ggplot(aes(x = Sub.Category)) + geom_bar(aes(color = Sub.Category))

#4.2
scat_plot <- superstore %>% ggplot(aes(x=Category,y=Sales)) + geom_point(aes(color= Category))
scat_plot
scat_plot+geom_smooth()



